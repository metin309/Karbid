var karbid={renderFile:function(e,t){karbid.utils.ajax.get(e,function(e){karbid.render(e,t)})},elements:{},binder:function(){this.duration=50,this.bindings=[],this.interval=setInterval(function(){for(this.i=0;i<karbid.binder.bindings.length;this.i++)this.binding=karbid.binder.bindings[i],this.binding.attr.includes(".")?"style"==this.binding.attr.split(".")[0]&&this.binding.element.style[this.binding.attr.split(".")[1]]!=function(){return eval(this.binding.value)}.call(this.binding.element)&&(this.binding.element.style[this.binding.attr.split(".")[1]]=function(){return eval(this.binding.value)}.call(this.binding.element)):this.binding.element[this.binding.attr]!=function(){return eval(this.binding.value)}.call(this.binding.element)&&(this.binding.element[this.binding.attr]=function(){return eval(this.binding.value)}.call(this.binding.element))},200)},render:function(code,curelem){var lines=code.split("\n"),inElements=[],curElement={},pass=!1;evalScript=!1,evalScriptCode="",void 0!=curelem&&(inElements.push({element:curelem,parent:{},elements:[],inLoop:!1,queryElement:{}}),curElement=inElements[0]),elementsCount=100;var attribute={name:"",value:""},curAttribute="",attrValue="",curEvent="",eventCode="",bracketCount=0,inLoop=!1,loop={},binding=!1,conditions=[{condition:!0}],conditionIndex=0;0==inElements.length&&(inElements.push({element:document.body,parent:{},elements:[],inLoop:!1,html:"",queryElement:{}}),curElement=inElements[0]);for(var a=0;a<lines.length;a++){var line=lines[a].trim();if(0==conditions[conditions.length-1].condition){if(!line.startsWith("endif"))continue;conditions[conditions.length-1].condition=!0}if(!pass){if(1==evalScript&&0==line.endsWith("endscript")&&(evalScriptCode+=line),line.startsWith("include")&&line.split(" ").length>1&&karbid.utils.ajax.get(line.split(" ")[1],function(e){karbid.render(e)}),line.startsWith("request")){var args=line.split("request ")[1].split(" "),argsObj={};if(args.length<3)console.error("Not enough arguments for request. Expected 3 got "+args.length);else{"post"!=args[0].toLowerCase()&&"get"!=args[0].toLowerCase()||(argsObj.method=args[0].toUpperCase()),argsObj.url=args[1],argsObj.url.startsWith("(")&&(argsObj.url=replaceAt(argsObj.url,argsObj.url.length-1,""),argsObj.url=replaceAt(argsObj.url,0,""),argsObj.url=eval(args[1])),argsObj.variable=args[2];var xmlHttp=new XMLHttpRequest;xmlHttp.onreadystatechange=function(){4==xmlHttp.readyState&&200==xmlHttp.status&&(window[argsObj.variable]=xmlHttp.responseText)},xmlHttp.open(argsObj.method,argsObj.url,!1),xmlHttp.send(null)}}if(line.startsWith("!")&&""==curAttribute&&""==curEvent&&(binding=!0,line=karbid.utils.replaceAt(line,0,"")),"@"==line[0]&&""==curAttribute&&""==curEvent){line=line.replace("@",""),line.endsWith("{")&&(line=karbid.utils.replaceAt(line,line.length-1,"")),line.endsWith(":{")&&(line=karbid.utils.replaceAt(line,line.length-1,""),line=karbid.utils.replaceAt(line,line.length-1,""));var element=karbid.utils.queryConverter(line);""!=element.tag&&""!=element.tag||(element.tag="div"),""==element.id&&(element.id="elem_"+elementsCount),0==curElement.inLoop&&void 0!=element.loop&&(curElement.loop={},curElement.loop=element.loop,curElement.loop.startingLine=a,curElement.loop.index=0,curElement.loop.to=element.loop.to-1,curElement.loop.name=element.loop.name,curElement.inLoop=!0,curElement.loop.type=element.loop.type,element.loop.array.length>0?curElement.element[element.loop.name]=element.loop.array[curElement.loop.index]:curElement.element[element.loop.name]=curElement.loop.index),curElement.inLoop&&("foreach"==element.loop.type?curElement.element[element.loop.name]=element.loop.array[curElement.loop.index]:curElement.element[element.loop.name]=curElement.loop.index),htmlElement=document.createElement(element.tag),curElement.inLoop&&(htmlElement[element.loop.name]=curElement.element[element.loop.name]),(void 0!=curElement.parent.loop||curElement.parent.parentInLoop)&&(curElement.parent.parentInLoop=!0,curElement.loop=curElement.parent.loop,htmlElement[curElement.parent.loop.name]=curElement.parent.element[curElement.parent.loop.name]),htmlElement.addEventListener("init",function(){if(""!=curElement.html){var text=document.createElement("text");text.innerHTML=eval(curElement.html),this.insertBefore(text,this.childNodes[curElement.htmlBefore])}}),curElement.element.appendChild(htmlElement);var objectElement={element:htmlElement,parent:curElement,elements:[],inLoop:!1,html:""};curElement.elements.push(objectElement),curElement=objectElement,curElement.queryElement=element,elementsCount++,karbid.elements[element.id]=htmlElement,htmlElement.id=element.id,""!=element.class&&(htmlElement.className=element.class.replace("."," ")),"body"==element.tag&&(htmlElement=document.body)}if(line.endsWith("}")&&0==bracketCount&&""==curAttribute&&""==curEvent){curElement.element.dispatchEvent(init);var le=curElement;curElement=curElement.parent,1==curElement.inLoop&&(void 0==curElement.loop.endingLine&&(curElement.loop.endingLine=a),curElement.loop.index<curElement.loop.to?(curElement.loop.index++,"foreach"==curElement.loop.type?le.element[curElement.loop.name]=curElement.loop.array[curElement.loop.index-1]:le.element[curElement.loop.name]=curElement.loop.index-1,a=curElement.loop.startingLine-1):curElement.inLoop=!1)}if(""!=curAttribute)if(line.replace("\\{","").includes("{")&&bracketCount++,line.endsWith("}")||line.replace("\\}","").includes("}"))if(bracketCount>0)bracketCount--;else{if(void 0!=curElement.element.getAttribute(curAttribute)&&(attrValue+=curElement.element.getAttribute(curAttribute)),"style"!=curAttribute)if("stylejs"==curAttribute)for(var style=function(){return eval("({"+attrValue+"})")}.call(curElement.element),i=0;i<Object.keys(style).length;i++){var key=Object.keys(style)[i];curElement.element.style[key]=style[key]}else curElement.element.setAttribute(curAttribute,function(){return eval(attrValue)}.call(curElement.element));else curElement.element.setAttribute(curAttribute,attrValue);binding&&(karbid.binder.bindings.push({element:curElement.element,attr:curAttribute,value:attrValue}),binding=!1),curAttribute="",attrValue=""}else attrValue+=line;if(line.startsWith("attr-")&&(curAttribute=line.split("attr-")[1].split(":")[0],"{"!=line[("attr-"+curAttribute+":").length+1]&&(attrValue=line.split("attr-"+curAttribute)[1].split(":")[1],curElement.element.setAttribute(curAttribute,function(){return eval(attrValue)}.call(curElement.element)),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:curAttribute,value:attrValue}),binding=!1),attrValue="",curAttribute="")),line.startsWith("html:")&&""==curAttribute&&""==curEvent&&(attrValue=line.split("html:")[1],binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"innerHTML",value:attrValue}),binding=!1),attrValue=""),""!=curEvent&&(line.endsWith("}}")?(void 0!=curElement.element.getAttribute("on"+curEvent)?curElement.element.setAttribute("on"+curEvent,curElement.element.getAttribute("on"+curEvent)+";"+eventCode):curElement.element.addEventListener(curEvent,new Function("ev",eventCode)),curEvent="",eventCode=""):eventCode+=line),""==curEvent&&""==curAttribute){if(line.startsWith("if")&&conditions.push({code:line.split("if")[1].trim(),condition:function(){return eval(line.split("if")[1].trim())}.call(curElement.element)}),line.startsWith("elif")){var con=!eval(conditions[conditions.length-1].code);conditions.push({code:line.split("elif")[1].trim(),condition:function(){return eval(line.split("elif")[1].trim()+" && "+con)}.call(curElement.element)})}if(line.startsWith("else")){var con=function(){return eval(conditions[conditions.length-1].code)}.call(curElement.element);conditions.push({code:"",condition:!con})}if((line.startsWith('"')||line.startsWith("html"))&&(line.startsWith('"')?(line=karbid.utils.replaceAt(line,0,""),line=karbid.utils.replaceAt(line,line.length-1,""),curElement.element.innerHTML=line):(curElement.html=line.split("html")[1].substr(line.split("html")[1].indexOf(":")+1),curElement.htmlBefore=curElement.elements.length)),line.startsWith("script")&&(evalScript=!0),line.endsWith("endscript")||line.startsWith("endscript")){evalScript=!1;var sT=document.createElement("script"),sP=document.createTextNode(evalScriptCode);sT.appendChild(sP),document.body.appendChild(sT),evalScriptCode="";continue}line.startsWith("ev-")&&(curEvent=line.split("ev-")[1].split(":")[0]),line.startsWith("style:")&&(curAttribute="style"),line.startsWith("stylejs")&&(curAttribute="stylejs"),line.startsWith("type:")&&(curAttribute="type",line.startsWith("type:{")||(attrValue=line.substr(curAttribute.length+1),curElement.element.setAttribute(curAttribute,function(){return eval(attrValue)}.call(curElement.element)),curAttribute="",attrValue="")),line.startsWith("placeholder:")&&(curAttribute="placeholder",line.startsWith("placeholder:{")||(attrValue=line.substr(curAttribute.length+1),curElement.element.setAttribute(curAttribute,function(){return eval(attrValue)}.call(curElement.element)),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:curAttribute,value:attrValue}),binding=!1),curAttribute="",attrValue="")),line.startsWith("click:")&&(curEvent="click"),line.startsWith("width:")&&(curElement.element.style.width=function(){return eval(line.split("width:")[1])}.call(curElement.element),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"style.width",value:line.split("width:")[1]}),binding=!1)),line.startsWith("height:")&&(curElement.element.style.height=function(){return eval(line.split("height:")[1])}.call(curElement.element),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"style.height",value:line.split("height:")[1]}),binding=!1)),line.startsWith("border:")&&(curElement.element.style.border=function(){return eval(line.split("border:")[1])}.call(curElement.element),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"style.border",value:line.split("border:")[1]}),binding=!1)),line.startsWith("background-color:")&&(curElement.element.style["background-color"]=function(){return eval(line.split("background-color:")[1])}.call(curElement.element),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"style.backgroundColor",value:line.split("background-color:")[1]}),binding=!1)),line.startsWith("style.")&&(curElement.element.style[line.split("style.")[1].split(":")[0].trim()]=function(){return eval(line.split("style.")[1].split(":")[1])}.call(curElement.element),binding&&(karbid.binder.bindings.push({element:curElement.element,attr:"style."+line.split("style.")[1].split(":")[0].trim(),value:line.split("style.")[1].split(":")[1]}),binding=!1)),line.startsWith("input:")&&(curEvent="input")}}}},utils:{of:function(e,t){var n;return n=void 0!=t&&1==t?document.querySelectorAll(e):document.querySelector(e)},replaceAt:function(e,t,n){return e.substring(0,t)+n+e.substring(t+1)},findElement:function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return e[n]},queryConverter:function(query){var element={id:"",tag:"",class:""};if(query.includes(":")&&query.includes("(")&&query.includes(")")){var name=query.split(":")[0].split("(")[1],to=eval(karbid.utils.replaceAt(query.substr(query.indexOf(":")+1),query.substr(query.indexOf(":")+1).length-1,"")),array=new Array,type="";to.constructor===Array?(array=to,to=array.length,type="foreach"):type="for",element.loop={type:type,name:name,to:to,array:array,index:0,binding:!0},query=query.split(":")[0].split("(")[0]}for(var splitter="",i=0;i<query.length&&("#"==query[i]&&(splitter="#"),"."==query[i]&&(splitter="."),"{"!=query[i]);i++)""==splitter&&(element.tag+=query[i]),"."==splitter&&(element.class+=query[i].replace("."," ")),"#"==splitter&&(element.id+=query[i].replace("#",""));return element.class=karbid.utils.replaceAt(element.class,0,""),element},ajax:{get:function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText)},n.open("GET",e,!1),n.send(null)},post:function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText)},n.open("POST",e,!1),n.send(null)}}}},init=new Event("init");karbid.binder=new karbid.binder;