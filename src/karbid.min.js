var karbid={renderFile:function(e,g){karbid.utils.ajax.get(e,function(d){karbid.render(d,g)})},elements:{},render:function(e,g){var d=e.split("\n"),h=[],b={},p=!1;void 0!=g&&(h.push({element:g,parent:{},elements:[],inLoop:!1}),b=h[0]);elementsCount=100;var f="",k="",m="",r="",t=0,n=[{condition:!0}];0==h.length&&(h.push({element:document.body,parent:{},elements:[],inLoop:!1,html:""}),b=h[0]);for(h=0;h<d.length;h++){var a=d[h].trim();if(0==n[n.length-1].condition)if(a.startsWith("endif"))n[n.length-
    1].condition=!0;else continue;if(!p){a.startsWith("<script")&&(p=!0);a.startsWith("</sc")&&(p=!1);a.startsWith("include")&&1<a.split(" ").length&&karbid.utils.ajax.get(a.split(" ")[1],function(a){karbid.render(a)});if(a.startsWith("request")){var c=a.split("request ")[1].split(" "),l={};if(3>c.length)console.error("Not enough arguments for request. Expected 3 got "+c.length);else{if("post"==c[0].toLowerCase()||"get"==c[0].toLowerCase())l.method=c[0].toUpperCase();l.url=c[1];l.url.startsWith("(")&&
    (l.url=replaceAt(l.url,l.url.length-1,""),l.url=replaceAt(l.url,0,""),console.log(l.url),l.url=eval(c[1]));l.variable=c[2];var q=new XMLHttpRequest;q.onreadystatechange=function(){4==q.readyState&&200==q.status&&(window[l.variable]=q.responseText)};q.open(l.method,l.url,!1);console.log(l);q.send(null)}}if("@"==a[0]&&""==f&&""==m){a=a.replace("@","");a.endsWith("{")&&(a=karbid.utils.replaceAt(a,a.length-1,""));a.endsWith(":{")&&(a=karbid.utils.replaceAt(a,a.length-1,""),a=karbid.utils.replaceAt(a,
    a.length-1,""));c=karbid.utils.queryConverter(a);if(""==c.tag||""==c.tag)c.tag="div";""==c.id&&(c.id="elem_"+elementsCount);0==b.inLoop&&void 0!=c.loop&&(b.loop={},b.loop=c.loop,b.loop.startingLine=h,b.loop.index=0,b.loop.to=c.loop.to-1,b.loop.name=c.loop.name,b.inLoop=!0,b.loop.type=c.loop.type,b.element[c.loop.name]=0<c.loop.array.length?c.loop.array[b.loop.index]:b.loop.index);b.inLoop&&("foreach"==c.loop.type?b.element[c.loop.name]=c.loop.array[b.loop.index]:(console.log(c.loop.name),b.element[c.loop.name]=
    b.loop.index));htmlElement=document.createElement(c.tag);htmlElement.addEventListener("init",function(){if(""!=b.html){var a=document.createElement("text");a.innerHTML=eval(b.html);this.insertBefore(a,this.firstChild)}});b.element.appendChild(htmlElement);b.inLoop&&htmlElement.setAttribute(c.loop.name,b.element[c.loop.name]);var u={element:htmlElement,parent:b,elements:[],inLoop:!1,html:""};b.elements.push(u);console.log(b.elements);b=u;elementsCount++;karbid.elements[c.id]=htmlElement;htmlElement.id=
    c.id;""!=c["class"]&&(htmlElement.className=c["class"].replace("."," "));"body"==c.tag&&(htmlElement=document.body)}a.endsWith("}")&&0==t&&""==f&&""==m&&(b.element.dispatchEvent(init),c=b,b=b.parent,1==b.inLoop&&(console.log(c),void 0==b.loop.endingLine&&(b.loop.endingLine=h),b.loop.index<b.loop.to?(b.loop.index++,"foreach"==b.loop.type?c.element[b.loop.name]=b.loop.array[b.loop.index]:(console.log(c.element),c.element[b.loop.name]=b.loop.index),h=b.loop.startingLine-1):b.inLoop=!1));if(""!=f)if(a.replace("\\{",
    "").includes("{")&&t++,a.endsWith("}")||a.replace("\\}","").includes("}"))if(0<t)t--;else{void 0!=b.element.getAttribute(f)&&(k+=b.element.getAttribute(f));if("style"!=f)if("stylejs"==f)for(f=eval("({"+k+"})"),k=0;k<Object.keys(f).length;k++)c=Object.keys(f)[k],b.element.style[c]=f[c];else b.element.setAttribute(f,eval(k));else b.element.setAttribute(f,k);k=f=""}else k+=a;a.startsWith("attr-")&&(f=a.split("attr-")[1].split(":")[0],"{"!=a[("attr-"+f+":").length+1]&&(k=a.split("attr-"+f)[1].split(":")[1],
    b.element.setAttribute(f,eval(k)),f=k=""));""!=m&&(a.endsWith("}}")?(void 0!=b.element.getAttribute("on"+m)?b.element.setAttribute("on"+m,b.element.getAttribute("on"+m)+";"+r):b.element.addEventListener(m,new Function("ev",r)),r=m=""):r+=a);if(""==m&&""==f){a.startsWith("if")&&(n.push({code:a.split("if")[1].trim(),condition:eval(a.split("if")[1].trim())}),console.log(a.split("if")[1].trim()));a.startsWith("elif")&&(c=!eval(n[n.length-1].code),n.push({code:a.split("elif")[1].trim(),condition:eval(a.split("elif")[1].trim()+
    " && "+c)}));a.startsWith("else")&&(c=eval(n[n.length-1].code),n.push({code:"",condition:!c}));if(a.startsWith('"')||a.startsWith("html"))a.startsWith('"')?(a=karbid.utils.replaceAt(a,0,""),a=karbid.utils.replaceAt(a,a.length-1,""),b.element.innerHTML=a):b.html=a.split("html")[1].substr(a.split("html")[1].indexOf(":")+1);a.startsWith("ev-")&&(m=a.split("ev-")[1].split(":")[0]);a.startsWith("style:")&&(f="style");a.startsWith("stylejs")&&(f="stylejs");a.startsWith("type:")&&(f="type",a.startsWith("type:{")||
    (k=a.substr(f.length+1),b.element.setAttribute(f,eval(k)),k=f=""));a.startsWith("placeholder:")&&(f="placeholder",a.startsWith("placeholder:{")||(k=a.substr(f.length+1),b.element.setAttribute(f,eval(k)),k=f=""));a.startsWith("click:")&&(m="click");a.startsWith("width:")&&(b.element.style.width=eval(a.split("width:")[1]));a.startsWith("height:")&&(b.element.style.height=eval(a.split("height:")[1]));a.startsWith("border:")&&(b.element.style.border=eval(a.split("border:")[1]));a.startsWith("background-color:")&&
    (b.element.style["background-color"]=eval(a.split("background-color:")[1]));a.startsWith("style.")&&(b.element.style[a.split("style.")[1].split(":")[0].trim()]=eval(a.split("style.")[1].split(":")[1]));a.startsWith("input:")&&(m="input")}}}},utils:{of:function(e,g){return void 0!=g?1==g?document.querySelectorAll(e):document.querySelector(e):document.querySelector(e)},replaceAt:function(e,g,d){return e.substring(0,g)+d+e.substring(g+1)},findElement:function(e,g){for(var d=0;d<e.length;d++)if(e[d]==
    g)return e[d]},queryConverter:function(e){var g={id:"",tag:"","class":"",important:!1};if(e.includes(":")&&e.includes("(")&&e.includes(")")){var d=e.split(":")[0].split("(")[1],h=eval(karbid.utils.replaceAt(e.split(d+":")[1].split("{")[0],e.split(d+":")[1].split("{")[0].length-1,""));h=eval(h);var b=[];if(h.constructor===Array){b=h;h=b.length;var p="foreach"}else p="for";g.loop={type:p,name:d,to:h,array:b,index:0};e=e.split(":")[0].split("(")[0]}d="";for(h=0;h<e.length;h++)"#"==e[h]&&(d="#"),"."==
    e[h]&&(d="."),""==d&&(g.tag+=e[h]),"."==d&&(g["class"]+=e[h].replace("."," ")),"#"==d&&(g.id+=e[h].replace("#",""));g["class"]=karbid.utils.replaceAt(g["class"],0,"");return g},ajax:{get:function(e,g){var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&200==d.status&&g(d.responseText)};d.open("GET",e,!1);d.send(null)},post:function(e,g){var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&200==d.status&&g(d.responseText)};d.open("POST",e,!1);d.send(null)}}}},
    init=new Event("init");